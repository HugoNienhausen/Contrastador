<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>News Finder</title>
  <style>
    :root { font-family: ui-sans-serif, system-ui, -apple-system; }
    body { margin: 10px; width: 320px; }
    button, select, input { font: inherit; }
    .row { display: flex; align-items: center; justify-content: space-between; margin: 8px 0; }
    .title { font-weight: 600; margin-top: 10px; }
    .muted { color: #666; font-size: 12px; }
    ul { list-style: none; padding: 0; margin: 6px 0; }
    li { margin: 4px 0; }
    a { text-decoration: none; color: #0a66c2; cursor: pointer; }
    .sep { border-top: 1px solid #eee; margin: 10px 0; }
    .pill { background:#f3f4f6; padding:2px 8px; border-radius:999px; font-size:12px; }
    .toggle { cursor: pointer; }
    #searchBtn { 
      background: #667eea; 
      color: white; 
      border: none; 
      padding: 8px 16px; 
      border-radius: 6px; 
      cursor: pointer; 
    }
    #searchBtn:hover { background: #5a67d8; }
    #searchBtn:disabled { 
      background: #ccc; 
      cursor: not-allowed; 
    }
    .status-success { color: #059669; }
    .status-error { color: #dc2626; }
    .status-loading { color: #0891b2; }
    
    /* Sources dropdown styles */
    .sources-dropdown {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin: 8px 0;
      padding: 12px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .search-container {
      margin-bottom: 12px;
    }
    
    #sourceSearch {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 14px;
    }
    
    .sources-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
    
    .source-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px;
      border: 2px solid #e5e7eb;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      position: relative;
    }
    
    .source-item:hover {
      border-color: #3b82f6;
      background: #f8fafc;
    }
    
    .source-item.selected {
      border-color: #3b82f6;
      background: #eff6ff;
    }
    
    .source-icon {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      margin-bottom: 4px;
    }
    
    .source-name {
      font-size: 11px;
      color: #374151;
      word-break: break-word;
      line-height: 1.2;
    }
    
    /* Custom media form styles */
    .custom-media-form {
      margin-bottom: 12px;
      padding: 12px;
      background: #f8fafc;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
    }
    
    .form-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    #customMediaUrl {
      flex: 1;
      padding: 6px 10px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 13px;
    }
    
    #addCustomMedia {
      padding: 6px 12px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
    }
    
    #addCustomMedia:hover {
      background: #2563eb;
    }
    
    #addCustomMedia:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    
    .form-help {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }
    
    .custom-media-item {
      position: relative;
    }
    
    .custom-media-item::after {
      content: "Custom";
      position: absolute;
      top: 2px;
      right: 2px;
      background: #10b981;
      color: white;
      font-size: 8px;
      padding: 1px 4px;
      border-radius: 2px;
      font-weight: 500;
    }
    
    /* Context menu styles */
    .context-menu {
      position: absolute;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      min-width: 120px;
      padding: 4px 0;
      display: none;
    }
    
    .context-menu-item {
      padding: 8px 12px;
      cursor: pointer;
      font-size: 13px;
      color: #374151;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .context-menu-item:hover {
      background: #f3f4f6;
    }
    
    .context-menu-item.delete {
      color: #dc2626;
    }
    
    .context-menu-item.delete:hover {
      background: #fef2f2;
    }
    
    .context-menu-separator {
      height: 1px;
      background: #e5e7eb;
      margin: 4px 0;
    }
    
    /* Preset buttons styles */
    .preset-btn {
      flex: 1;
      padding: 6px 12px;
      margin: 0 2px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      background: #f9fafb;
      color: #374151;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s ease;
    }
    
    .preset-btn:hover {
      background: #f3f4f6;
      border-color: #9ca3af;
    }
    
    .preset-btn:active {
      background: #e5e7eb;
      transform: translateY(1px);
    }
  </style>
</head>
<body>
  <div class="row">
    <button id="searchBtn">🔎 Search selection</button>
    <span id="status" class="muted"></span>
  </div>

  <div class="sep"></div>

  <div class="row">
    <span class="title">Sources</span>
    <a id="toggleSources">Manage (<span id="sourceCount">0</span>)</a>
  </div>
  
  <div id="sourcesDropdown" class="sources-dropdown" style="display: none;">
    <div class="search-container">
      <input type="text" id="sourceSearch" placeholder="Search media..." />
    </div>
    
    <div class="custom-media-form">
      <div class="form-row">
        <input type="text" id="customMediaUrl" placeholder="Add custom media URL (e.g. example.com)" />
        <button id="addCustomMedia">Add</button>
      </div>
      <div class="form-help">Add any website domain to your sources</div>
    </div>
    
    <div class="sources-grid" id="sourcesGrid">
      <!-- Los medios se cargarán aquí dinámicamente -->
    </div>
    
    <!-- Context menu for custom media -->
    <div class="context-menu" id="contextMenu">
      <div class="context-menu-item delete" id="deleteCustomMedia">
        <span>🗑️</span>
        <span>Delete custom media</span>
      </div>
    </div>
  </div>

  <div class="sep"></div>

  <div class="title">Preferences</div>
  <div class="row">
    <label for="limit">Results</label>
    <select id="limit">
      <option>5</option>
      <option selected>8</option>
      <option>10</option>
    </select>
  </div>

  <div class="row">
    <label for="openMode">Open in</label>
    <select id="openMode">
      <option value="tab">New tab</option>
      <option value="notification">Notification</option>
    </select>
  </div>
  <div class="row">
    <label for="country">Country</label>
    <select id="country">
      <option value="es" selected>🇪🇸 Spain</option>
      <option value="de">🇩🇪 Germany</option>
      <option value="fr">🇫🇷 France</option>
      <option value="uk">🇬🇧 United Kingdom</option>
      <option value="us">🇺🇸 United States</option>
    </select>
  </div>

  <div class="row">
    <label class="toggle">
      <input type="checkbox" id="privacyNoHistory" />
      Don't save history
    </label>
  </div>

  <div class="sep"></div>

  <div class="row">
    <span class="title">Advanced Settings</span>
    <a id="toggleAdvanced">Configure</a>
  </div>

  <div id="advancedDropdown" class="sources-dropdown" style="display: none;">
    <div class="title" style="margin-top: 0; margin-bottom: 12px;">🔧 Search Configuration</div>
    
    <div class="row">
      <label for="sortBy">Sort by</label>
      <select id="sortBy">
        <option value="relevance" selected>📊 Relevance</option>
        <option value="date">📅 Date (newest first)</option>
        <option value="mixed">⚖️ Mixed (smart)</option>
      </select>
    </div>
    
    <div class="row">
      <label for="timeRange">Time range</label>
      <select id="timeRange">
        <option value="any" selected>🌐 Any time</option>
        <option value="d1">⏰ Last 24 hours</option>
        <option value="d7">📆 Last week</option>
        <option value="m1">📅 Last month</option>
        <option value="m3">🗓️ Last 3 months</option>
        <option value="m6">📊 Last 6 months</option>
        <option value="y1">🗂️ Last year</option>
      </select>
    </div>
    
    <div class="row">
      <label for="contentType">Content type</label>
      <select id="contentType">
        <option value="any" selected>📰 Any content</option>
        <option value="news">⚡ Breaking news</option>
        <option value="analysis">🔍 Analysis & Opinion</option>
        <option value="reports">📋 Reports & Investigations</option>
      </select>
    </div>
    
    <div class="row">
      <label for="searchMode">Search mode</label>
      <select id="searchMode">
        <option value="balanced" selected>⚖️ Balanced</option>
        <option value="exact">🎯 Exact matches</option>
        <option value="broad">🌊 Broad & related</option>
        <option value="semantic">🧠 Semantic search</option>
      </select>
    </div>
    
    <div class="title" style="margin-top: 16px; margin-bottom: 8px;">Quick Presets</div>
    
    <div class="row">
      <button id="presetBreaking" class="preset-btn">⚡ Breaking News</button>
      <button id="presetAnalysis" class="preset-btn">🔍 Analysis</button>
    </div>
    
    <div class="row">
      <button id="presetResearch" class="preset-btn">📚 Research</button>
      <button id="presetReset" class="preset-btn">🔄 Reset</button>
    </div>
    
    <div class="row">
      <label class="toggle">
        <input type="checkbox" id="diversifySources" checked />
        🔄 Diversify sources
      </label>
    </div>
    
    <div class="row">
      <label class="toggle">
        <input type="checkbox" id="trustedOnly" />
        ✅ Trusted sources only
      </label>
    </div>
  </div>

  <div class="sep"></div>

  <div class="title">History</div>
  <ul id="history"></ul>
  <div class="row">
    <span class="muted">Last 3</span>
    <a id="clearHistory">Clear</a>
  </div>

  <script src="popup.js"></script>
</body>
</html>
